package programa;


import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
import java.util.stream.Collectors;

import entities.Dependentes;
import entities.Funcionario;
import entities.Setor;

public class Cadastro {
    public static void main(String[] args) throws ParseException {

        Scanner sc = new Scanner(System.in);

        List<Funcionario> funcionarios = new ArrayList<>();

        System.out.print("Entre com o numero de funcionarios: ");
        int qtdFuncionarios = sc.nextInt();
        sc.nextLine();

        SimpleDateFormat fmt1 = new SimpleDateFormat("dd/MM/yyyy");

        for (int i = 1; i <= qtdFuncionarios; i++) {
            System.out.println("Entre com os dados do funcionario " + i);

            System.out.print("Digite o Nome:");
            String nome = sc.nextLine();

            System.out.print("Digite a data de nascimento do funcionario: " + i);
            Date dataNascimentoFunc = fmt1.parse(sc.nextLine());

            System.out.println("Digite a matricula do funcionario " + i);
            int matricula = sc.nextInt();
            sc.nextLine();

            System.out.println("Digite o codigo do setor: ");
            int codSetor = sc.nextInt();
            sc.nextLine();

            System.out.println("Digite a descricao do setor: ");
            String descSetor = sc.nextLine();


            System.out.println("O funcionario " + i + " tem dependentes s/n? ");
            char resp = sc.next().charAt(0);
            sc.nextLine();
            List<Dependentes> dependentes = new ArrayList<>();

            if (resp == 's') {

                SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
                System.out.println("Digite o numero de dependentes do funcionario " + i);
                int qtdDependentes = sc.nextInt();
                sc.nextLine();

                for (int j = 1; j <= qtdDependentes; j++) {
                    System.out.println("Digite o nome do dependente n° " + j);
                    String nomeDependente = sc.nextLine();

                    System.out.println("Digite a data de nascimento do dependente n° " + j);
                    Date dataNascimentoDependente = sdf.parse(sc.nextLine());

                    Dependentes dependente = new Dependentes(nomeDependente, dataNascimentoDependente);

                    dependentes.add(dependente);

                }
            }

            System.out.println("________________");

            Funcionario funcionario = new Funcionario(nome, matricula, new Setor(codSetor, descSetor),dataNascimentoFunc,  dependentes);

            funcionarios.add(funcionario);
        }

        for (Funcionario funcionario : funcionarios) {
            System.out.println(funcionario);
        }

        System.out.println("Você gostaria de filtrar por setor? s/n");
        char respSetor = sc.nextLine().charAt(0);

        if (respSetor == 's') {
            System.out.println("Digite o código do setor, por favor.");
            int respCodSetor = sc.nextInt();

            final List<Funcionario> funcionariosFiltrados = funcionarios.stream().filter(funcionario -> funcionario.getSetor().getCodigo() == respCodSetor).collect(Collectors.toList());

            funcionariosFiltrados.forEach(System.out::println);
            System.out.println("Quantidades de funcionarios nesse setor: " + funcionariosFiltrados.size());

        }
        sc.close();

    }
}
